import React, { useEffect, useContext } from "react";
import gsap from "gsap";
import { MainContext } from "../../context/context";
import { Link, useLocation } from "react-router-dom";

export default function Tabbar() {
	const { setShowTempBoxes, showTempBoxes } = useContext(MainContext);
	const location = useLocation();

	useEffect(() => {
		const tabbar = document.querySelector("#tabbar");
		const background = tabbar.querySelector(".background path");

		if (location.pathname == "/") {
			const button = tabbar.querySelector("li.add button");

			button.addEventListener("pointerdown", (e) => {
				gsap.to(background, {
					duration: 0.2,
				});
				gsap.to(tabbar, {
					duration: 0.2,
					"--menu-icon-add-opacity": 1,
					"--menu-icon-move": 8,
				});
			});

			button.addEventListener("pointerup", (e) => {
				button.classList.toggle("open");
				let open = button.classList.contains("open");
				gsap.to(background, {
					keyframes: [
						{
							duration: 0.1,
						},
						{
							duration: 0.7,
							delay: 0.05,
							ease: "elastic.out(1, .5)",
						},
					],
				});
				gsap.to(tabbar, {
					duration: 0.3,
					"--menu-icon-add-opacity": 0,
					"--menu-icon-rotate": open ? 45 : 90,
					onComplete() {
						if (!open) {
							gsap.set(tabbar, {
								"--menu-icon-rotate": 0,
							});
						}
					},
				});
				gsap.to(tabbar, {
					duration: 0.8,
					ease: "elastic.out(1, .5)",
					"--menu-icon-move": 0,
				});
				gsap.to(tabbar, {
					duration: open ? 0.6 : 0.3,
					ease: open ? "elastic.out(1, .75)" : "power1.out",
					"--options-y": open ? -112 : 16,
				});
				gsap.to(tabbar, {
					duration: open ? 0.6 : 0.3,
					delay: 0.05,
					ease: open ? "elastic.out(1, .75)" : "power1.out",
					"--options-middle-y": open ? -112 : 16,
				});
				gsap.to(tabbar, {
					"--options-opacity": open ? 1 : 0,
					duration: open ? 0.5 : 0.25,
				});
			});
		}
	}, [location]);

	function handleAddItem() {
		if (showTempBoxes) {
			setShowTempBoxes(false);
		} else {
			setShowTempBoxes(true);
		}
	}

	return (
		<>
			<div id="tabbar">
				<ul className="options">
					<li>
						<button>
							<svg viewBox="0 0 16 16">
								<path d="M2,1.25 C1.46957,1.25 0.96086,1.45318464 0.58579,1.81486893 C0.21071,2.17654357 0,2.66708536 0,3.17857143 L0,12.8214286 C0,13.3328857 0.21071,13.8234179 0.58579,14.1851214 C0.96086,14.546825 1.46957,14.75 2,14.75 L14,14.75 C14.5304,14.75 15.0391,14.546825 15.4142,14.1851214 C15.7893,13.8234179 16,13.3328857 16,12.8214286 L16,3.17857143 C16,2.66708536 15.7893,2.17654357 15.4142,1.81486893 C15.0391,1.45318464 14.5304,1.25 14,1.25 L2,1.25 Z M14,12.8214286 L2,12.8214286 L6,5.10714286 L9,10.8928571 L11,7.03571429 L14,12.8214286 Z" />
							</svg>
						</button>
					</li>
					<li>
						<button onClick={handleAddItem}>
							<svg
								xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 448 512"
							>
								<path d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z" />
							</svg>
						</button>
					</li>
					<li>
						<button>
							<svg viewBox="0 0 16 16">
								<path d="M0,3.66666667 C0,3.09203417 0.21071,2.54093167 0.58579,2.13460583 C0.96086,1.72826917 1.46957,1.5 2,1.5 L7,1.5 L9,3.66666667 L14,3.66666667 C14.5304,3.66666667 15.0391,3.89493583 15.4142,4.3012725 C15.7893,4.70759833 16,5.25870083 16,5.83333333 L16,12.3333333 C16,12.9079333 15.7893,13.459025 15.4142,13.8653833 C15.0391,14.2717417 14.5304,14.5 14,14.5 L2,14.5 C1.46957,14.5 0.96086,14.2717417 0.58579,13.8653833 C0.21071,13.459025 0,12.9079333 0,12.3333333 L0,3.66666667 Z" />
							</svg>
						</button>
					</li>
				</ul>
				<ul className="menu">
					<li className="menu_item-dashboard">
						<Link to="/dashboard">
							<button>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									viewBox="0 0 512 512"
								>
									<title>Bar Chart</title>
									<path d="M480 496H48a32 32 0 01-32-32V32a16 16 0 0132 0v432h432a16 16 0 010 32z" />
									<path d="M156 432h-40a36 36 0 01-36-36V244a36 36 0 0136-36h40a36 36 0 0136 36v152a36 36 0 01-36 36zM300 432h-40a36 36 0 01-36-36V196a36 36 0 0136-36h40a36 36 0 0136 36v200a36 36 0 01-36 36zM443.64 432h-40a36 36 0 01-36-36V132a36 36 0 0136-36h40a36 36 0 0136 36v264a36 36 0 01-36 36z" />
								</svg>
							</button>
						</Link>
					</li>
					{location.pathname == "/" ? (
						<li className="add">
							<button>
								<svg viewBox="0 0 24 24">
									<line x1="12" y1="3" x2="12" y2="21" />
									<line x1="21" y1="12" x2="3" y2="12" />
								</svg>
							</button>
						</li>
					) : (
						<li>
							<Link to="/">
								<button>
									<svg
										xmlns="http://www.w3.org/2000/svg"
										viewBox="0 0 512 512"
									>
										<title>Grid</title>
										<path d="M204 240H68a36 36 0 01-36-36V68a36 36 0 0136-36h136a36 36 0 0136 36v136a36 36 0 01-36 36zM444 240H308a36 36 0 01-36-36V68a36 36 0 0136-36h136a36 36 0 0136 36v136a36 36 0 01-36 36zM204 480H68a36 36 0 01-36-36V308a36 36 0 0136-36h136a36 36 0 0136 36v136a36 36 0 01-36 36zM444 480H308a36 36 0 01-36-36V308a36 36 0 0136-36h136a36 36 0 0136 36v136a36 36 0 01-36 36z" />
									</svg>
								</button>
							</Link>
						</li>
					)}

					<li>
						<Link to="/settings">
							<button>
								<svg viewBox="0 0 16 16" fillRule="evenodd">
									<path d="M9.39692247,1.59689214 C9.04066156,0.134369287 6.95933844,0.134369287 6.60307753,1.59689214 C6.54989153,1.81666432 6.44556333,2.02077064 6.29859633,2.19259832 C6.15161996,2.36443538 5.96615803,2.49913749 5.757286,2.58575446 C5.54841398,2.67237144 5.32204768,2.70844701 5.09660015,2.69105611 C4.87115262,2.67366521 4.65299906,2.60328599 4.4598869,2.48565603 C3.1735975,1.70189378 1.70167743,3.17379178 2.48545143,4.46006188 C2.99171693,5.29069985 2.54264068,6.37446679 1.59761174,6.60415788 C0.13412942,6.95947593 0.13412942,9.04169596 1.59761174,9.3960765 C1.81744347,9.44932733 2.02159035,9.55376647 2.19342999,9.70086251 C2.36526025,9.84795856 2.49992687,10.0334927 2.58646077,10.2424647 C2.67299467,10.4514367 2.70895827,10.6779403 2.69139836,10.9034126 C2.67384782,11.1288848 2.60328004,11.3471382 2.48545143,11.5401725 C1.70167743,12.8264426 3.1735975,14.2983406 4.4598869,13.5145784 C4.65296156,13.3967328 4.87114324,13.3262317 5.09664702,13.3086064 C5.3221508,13.2910749 5.54862024,13.3270754 5.75759539,13.413608 C5.96657991,13.5001406 6.1521731,13.6347677 6.2992526,13.8066142 C6.44634148,13.9784606 6.55076343,14.1825575 6.60401506,14.4024047 C6.95933844,15.8658651 9.04159909,15.8658651 9.39598494,14.4024047 C9.44942408,14.1826513 9.55395853,13.9786481 9.70105678,13.8069892 C9.84815504,13.6352365 10.033692,13.5007031 10.2426671,13.4141705 C10.4515485,13.3276379 10.6779617,13.2916374 10.9034374,13.3090751 C11.1288193,13.3266067 11.3469822,13.3969203 11.5401131,13.5145784 C12.8264025,14.2983406 14.2983226,12.8264426 13.5145486,11.5401725 C13.3968887,11.3470445 13.3265741,11.1288848 13.3090423,10.9035063 C13.2916042,10.678034 13.3276053,10.4516242 13.4141392,10.242746 C13.5006731,10.033774 13.6352085,9.84823982 13.8069638,9.70114377 C13.9786253,9.55404772 14.1826315,9.44951484 14.4023883,9.3960765 C15.8658706,9.04075845 15.8658706,6.95853841 14.4023883,6.60415788 C14.1825378,6.55089767 13.9784378,6.44647729 13.8065888,6.29939999 C13.6347398,6.15231332 13.5001106,5.96673229 13.4135767,5.7577509 C13.3270428,5.54876951 13.2910417,5.32231285 13.3085735,5.09680308 C13.3261053,4.87130268 13.3967012,4.65313364 13.5145486,4.46006188 C14.2983226,3.17379178 12.8264025,1.70189378 11.5401131,2.48565603 C11.3470759,2.60348287 11.1288193,2.67404959 10.9033436,2.69159987 C10.6778679,2.70915014 10.451361,2.67319646 10.2423859,2.58666385 C10.0334107,2.50013125 9.84787378,2.36546665 9.70077552,2.19362959 C9.55367727,2.0218019 9.44923657,1.81765809 9.39598494,1.59782965 L9.39692247,1.59689214 Z M7.99999531,10.8126611 C8.74590253,10.8126611 9.46133069,10.5163128 9.98878434,9.98886701 C10.516238,9.46142127 10.8125908,8.74600384 10.8125908,8.00011719 C10.8125908,7.25418366 10.516238,6.53880373 9.98878434,6.01134861 C9.46133069,5.4838935 8.74590253,5.18757324 7.99999531,5.18757324 C7.25405059,5.18757324 6.53865993,5.4838935 6.01119691,6.01134861 C5.48373388,6.53880373 5.18740918,7.25418366 5.18740918,8.00011719 C5.18740918,8.74600384 5.48373388,9.46142127 6.01119691,9.98886701 C6.53865993,10.5163128 7.25405059,10.8126611 7.99999531,10.8126611 Z" />
								</svg>
							</button>
						</Link>
					</li>
				</ul>
			</div>
		</>
	);
}
