import React, { useEffect, useContext } from "react";
import gsap from "gsap";
import { MainContext } from "../../context/context";
import { Link, useLocation } from "react-router-dom";

export default function Tabbar() {
	const { setShowTempBoxes, showTempBoxes } = useContext(MainContext);
	const location = useLocation();

	useEffect(() => {
		const tabbar = document.querySelector("#tabbar");

		if (location.pathname == "/") {
			const edit_button = tabbar.querySelector("li.edit #create");

			edit_button.addEventListener("pointerdown", (e) => {
				gsap.to(tabbar, {
					duration: 0.2,
					"--menu-icon-edit-opacity": 1,
					"--menu-icon-move": 8,
				});
			});

			edit_button.addEventListener("pointerup", (e) => {
				edit_button.classList.toggle("open");
				let open = edit_button.classList.contains("open");
				gsap.to(tabbar, {
					duration: 0.3,
					"--menu-icon-edit-opacity": 0,
					"--menu-icon-rotate": open ? 45 : 0,
					onComplete() {
						if (!open) {
							gsap.set(tabbar, {
								"--menu-icon-rotate": 0,
							});
						}
					},
				});
				gsap.to(tabbar, {
					duration: 0.8,
					ease: "elastic.out(1, .5)",
					"--menu-icon-move": 0,
				});
				gsap.to(tabbar, {
					duration: open ? 0.6 : 0.3,
					ease: open ? "elastic.out(1, .75)" : "power1.out",
					"--options-y": open ? -112 : 16,
				});
				gsap.to(tabbar, {
					duration: open ? 0.6 : 0.3,
					delay: 0.05,
					ease: open ? "elastic.out(1, .75)" : "power1.out",
					"--options-middle-y": open ? -112 : 16,
				});
				gsap.to(tabbar, {
					"--options-opacity": open ? 1 : 0,
					duration: open ? 0.5 : 0.25,
				});
			});
		}
	}, [location]);

	function handleAddItem() {
		if (showTempBoxes) {
			setShowTempBoxes(false);
		} else {
			setShowTempBoxes(true);
		}
	}

	return (
		<>
			<div id="tabbar">
				<ul className="options">
					<li>
						<button>
							<svg
								width="70"
								height="70"
								viewBox="0 0 70 70"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<rect
									width="70"
									height="70"
									rx="35"
									fill="white"
								/>
								<path
									d="M36.5886 17.6591C35.7099 16.7803 34.283 16.7803 33.4044 17.6591L28.9057 22.1587C28.259 22.8055 28.0692 23.7687 28.4207 24.6123C28.7721 25.456 29.5875 26.0044 30.5013 26.0044H32.7507V32.7537H26.0026V30.4969C26.0026 29.59 25.4544 28.7674 24.6109 28.4159C23.7674 28.0644 22.8044 28.2612 22.1577 28.901L17.659 33.4005C16.7803 34.2794 16.7803 35.7066 17.659 36.5854L22.1577 41.085C22.8044 41.7318 23.7674 41.9216 24.6109 41.5701C25.4544 41.2185 26.0026 40.403 26.0026 39.489V37.2463H32.7507V43.9956H30.5013C29.5946 43.9956 28.7721 44.544 28.4207 45.3877C28.0692 46.2313 28.266 47.1945 28.9057 47.8413L33.4044 52.3409C34.283 53.2197 35.7099 53.2197 36.5886 52.3409L41.0873 47.8413C41.734 47.1945 41.9238 46.2313 41.5723 45.3877C41.2208 44.544 40.4054 43.9956 39.4917 43.9956H37.2493V37.2463H43.9974V39.496C43.9974 40.403 44.5456 41.2256 45.3891 41.5771C46.2326 41.9286 47.1956 41.7318 47.8423 41.092L52.341 36.5924C53.2197 35.7136 53.2197 34.2864 52.341 33.4076L47.8423 28.908C47.1956 28.2612 46.2326 28.0714 45.3891 28.4229C44.5456 28.7744 43.9974 29.59 43.9974 30.504V32.7537H37.2493V25.9974H39.4987C40.4054 25.9974 41.2279 25.449 41.5793 24.6053C41.9308 23.7616 41.734 22.7985 41.0943 22.1516L36.5956 17.6521L36.5886 17.6591Z"
									fill="black"
								/>
							</svg>
						</button>
					</li>
					<li>
						<button onClick={handleAddItem}>
							<svg
								width="70"
								height="70"
								viewBox="0 0 70 70"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<rect
									width="70"
									height="70"
									rx="35"
									fill="white"
								/>
								<path
									d="M37.7692 19.7623C37.7692 18.2344 36.5317 17 35 17C33.4683 17 32.2308 18.2344 32.2308 19.7623V32.1927H19.7692C18.2375 32.1927 17 33.4271 17 34.955C17 36.4829 18.2375 37.7173 19.7692 37.7173H32.2308V50.1477C32.2308 51.6756 33.4683 52.91 35 52.91C36.5317 52.91 37.7692 51.6756 37.7692 50.1477V37.7173H50.2308C51.7625 37.7173 53 36.4829 53 34.955C53 33.4271 51.7625 32.1927 50.2308 32.1927H37.7692V19.7623Z"
									fill="black"
								/>
							</svg>
						</button>
					</li>
				</ul>
				<ul className="menu">
					<li className="menu_item-dashboard">
						<Link to="/dashboard">
							<button>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									viewBox="0 0 512 512"
								>
									<path d="M480 496H48a32 32 0 01-32-32V32a16 16 0 0132 0v432h432a16 16 0 010 32z" />
									<path d="M156 432h-40a36 36 0 01-36-36V244a36 36 0 0136-36h40a36 36 0 0136 36v152a36 36 0 01-36 36zM300 432h-40a36 36 0 01-36-36V196a36 36 0 0136-36h40a36 36 0 0136 36v200a36 36 0 01-36 36zM443.64 432h-40a36 36 0 01-36-36V132a36 36 0 0136-36h40a36 36 0 0136 36v264a36 36 0 01-36 36z" />
								</svg>
							</button>
						</Link>
					</li>
					{location.pathname == "/" ? (
						<li className="edit">
							<button id="create">
								<svg
									xmlns="http://www.w3.org/2000/svg"
									viewBox="0 0 512 512"
								>
									<path d="M459.94 53.25a16.06 16.06 0 00-23.22-.56L424.35 65a8 8 0 000 11.31l11.34 11.32a8 8 0 0011.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90L218.82 270.2a9 9 0 00-2.31 3.93L208.16 299a3.91 3.91 0 004.86 4.86l24.85-8.35a9 9 0 003.93-2.31L422 112.66a9 9 0 000-12.66l-9.95-10a9 9 0 00-12.71 0z" />
									<path d="M386.34 193.66L264.45 315.79A41.08 41.08 0 01247.58 326l-25.9 8.67a35.92 35.92 0 01-44.33-44.33l8.67-25.9a41.08 41.08 0 0110.19-16.87l122.13-121.91a8 8 0 00-5.65-13.66H104a56 56 0 00-56 56v240a56 56 0 0056 56h240a56 56 0 0056-56V199.31a8 8 0 00-13.66-5.65z" />
								</svg>
							</button>
						</li>
					) : (
						<li>
							<Link to="/">
								<button>
									<svg viewBox="0 0 16 16">
										<path d="M8.70806672,0.774494228 C8.52027842,0.598738796 8.26558741,0.5 7.99997964,0.5 C7.73442195,0.5 7.47972093,0.598738796 7.29190258,0.774494228 L0.281139469,7.33708036 C0.0986993821,7.51389518 -0.00224559136,7.75071079 1.02463177e-13,7.99652652 C0.00231140466,8.24234224 0.107643113,8.47747033 0.293338197,8.65128511 C0.479033281,8.82509989 0.730228923,8.92372619 0.992832079,8.92588246 C1.25543523,8.92803874 1.50842363,8.8335375 1.69731362,8.66272276 L1.99076413,8.38803166 L1.99076413,14.5624877 C1.99076413,14.811116 2.09628613,15.0496191 2.28410447,15.2254026 C2.47193283,15.4011862 2.72667392,15.5 2.99230172,15.5 L4.99537689,15.5 C5.26100469,15.5 5.51574578,15.4011862 5.70357414,15.2254026 C5.89139248,15.0496191 5.99691448,14.811116 5.99691448,14.5624877 L5.99691448,12.6874631 C5.99691448,12.4388348 6.10243648,12.2003317 6.29025483,12.0245481 C6.47808318,11.8487646 6.73282427,11.7499508 6.99845207,11.7499508 L9.00151723,11.7499508 C9.267125,11.7499508 9.52191616,11.8487646 9.70970446,12.0245481 C9.89759291,12.2003317 10.0030548,12.4388348 10.0030548,12.6874631 L10.0030548,14.5624877 C10.0030548,14.811116 10.1086169,15.0496191 10.2964052,15.2254026 C10.4841935,15.4011862 10.7389846,15.5 11.0045924,15.5 L13.0076676,15.5 C13.2732753,15.5 13.5280665,15.4011862 13.7158548,15.2254026 C13.9037433,15.0496191 14.0092052,14.811116 14.0092052,14.5624877 L14.0092052,8.38803166 L14.3026557,8.66272276 C14.4915457,8.8335375 14.7445341,8.92803874 15.0071372,8.92588246 C15.2697404,8.92372619 15.520926,8.82509989 15.7066111,8.65128511 C15.8922961,8.47747033 15.9976579,8.24234224 16,7.99652652 C16.002265,7.75071079 15.90131,7.51389518 15.7188298,7.33708036 L8.70806672,0.774494228 Z" />
									</svg>
								</button>
							</Link>
						</li>
					)}

					<li>
						<Link to="/settings">
							<button>
								<svg viewBox="0 0 16 16" fillRule="evenodd">
									<path d="M9.39692247,1.59689214 C9.04066156,0.134369287 6.95933844,0.134369287 6.60307753,1.59689214 C6.54989153,1.81666432 6.44556333,2.02077064 6.29859633,2.19259832 C6.15161996,2.36443538 5.96615803,2.49913749 5.757286,2.58575446 C5.54841398,2.67237144 5.32204768,2.70844701 5.09660015,2.69105611 C4.87115262,2.67366521 4.65299906,2.60328599 4.4598869,2.48565603 C3.1735975,1.70189378 1.70167743,3.17379178 2.48545143,4.46006188 C2.99171693,5.29069985 2.54264068,6.37446679 1.59761174,6.60415788 C0.13412942,6.95947593 0.13412942,9.04169596 1.59761174,9.3960765 C1.81744347,9.44932733 2.02159035,9.55376647 2.19342999,9.70086251 C2.36526025,9.84795856 2.49992687,10.0334927 2.58646077,10.2424647 C2.67299467,10.4514367 2.70895827,10.6779403 2.69139836,10.9034126 C2.67384782,11.1288848 2.60328004,11.3471382 2.48545143,11.5401725 C1.70167743,12.8264426 3.1735975,14.2983406 4.4598869,13.5145784 C4.65296156,13.3967328 4.87114324,13.3262317 5.09664702,13.3086064 C5.3221508,13.2910749 5.54862024,13.3270754 5.75759539,13.413608 C5.96657991,13.5001406 6.1521731,13.6347677 6.2992526,13.8066142 C6.44634148,13.9784606 6.55076343,14.1825575 6.60401506,14.4024047 C6.95933844,15.8658651 9.04159909,15.8658651 9.39598494,14.4024047 C9.44942408,14.1826513 9.55395853,13.9786481 9.70105678,13.8069892 C9.84815504,13.6352365 10.033692,13.5007031 10.2426671,13.4141705 C10.4515485,13.3276379 10.6779617,13.2916374 10.9034374,13.3090751 C11.1288193,13.3266067 11.3469822,13.3969203 11.5401131,13.5145784 C12.8264025,14.2983406 14.2983226,12.8264426 13.5145486,11.5401725 C13.3968887,11.3470445 13.3265741,11.1288848 13.3090423,10.9035063 C13.2916042,10.678034 13.3276053,10.4516242 13.4141392,10.242746 C13.5006731,10.033774 13.6352085,9.84823982 13.8069638,9.70114377 C13.9786253,9.55404772 14.1826315,9.44951484 14.4023883,9.3960765 C15.8658706,9.04075845 15.8658706,6.95853841 14.4023883,6.60415788 C14.1825378,6.55089767 13.9784378,6.44647729 13.8065888,6.29939999 C13.6347398,6.15231332 13.5001106,5.96673229 13.4135767,5.7577509 C13.3270428,5.54876951 13.2910417,5.32231285 13.3085735,5.09680308 C13.3261053,4.87130268 13.3967012,4.65313364 13.5145486,4.46006188 C14.2983226,3.17379178 12.8264025,1.70189378 11.5401131,2.48565603 C11.3470759,2.60348287 11.1288193,2.67404959 10.9033436,2.69159987 C10.6778679,2.70915014 10.451361,2.67319646 10.2423859,2.58666385 C10.0334107,2.50013125 9.84787378,2.36546665 9.70077552,2.19362959 C9.55367727,2.0218019 9.44923657,1.81765809 9.39598494,1.59782965 L9.39692247,1.59689214 Z M7.99999531,10.8126611 C8.74590253,10.8126611 9.46133069,10.5163128 9.98878434,9.98886701 C10.516238,9.46142127 10.8125908,8.74600384 10.8125908,8.00011719 C10.8125908,7.25418366 10.516238,6.53880373 9.98878434,6.01134861 C9.46133069,5.4838935 8.74590253,5.18757324 7.99999531,5.18757324 C7.25405059,5.18757324 6.53865993,5.4838935 6.01119691,6.01134861 C5.48373388,6.53880373 5.18740918,7.25418366 5.18740918,8.00011719 C5.18740918,8.74600384 5.48373388,9.46142127 6.01119691,9.98886701 C6.53865993,10.5163128 7.25405059,10.8126611 7.99999531,10.8126611 Z" />
								</svg>
							</button>
						</Link>
					</li>
				</ul>
			</div>
		</>
	);
}
